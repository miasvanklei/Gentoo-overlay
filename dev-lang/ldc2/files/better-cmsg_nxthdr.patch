--- a/runtime/druntime/src/core/sys/posix/sys/socket.d	2016-10-23 23:06:21.003877299 +0200
+++ b/runtime/druntime/src/core/sys/posix/sys/socket.d	2016-10-23 23:11:50.405868120 +0200
@@ -194,10 +194,13 @@
         extern (D) inout(ubyte)*   CMSG_DATA( inout(cmsghdr)* cmsg ) pure nothrow @nogc { return cast(ubyte*)( cmsg + 1 ); }
     }
 
-    private inout(cmsghdr)* __cmsg_nxthdr(inout(msghdr)*, inout(cmsghdr)*) pure nothrow @nogc;
-    extern (D)  inout(cmsghdr)* CMSG_NXTHDR(inout(msghdr)* msg, inout(cmsghdr)* cmsg) pure nothrow @nogc
+    extern (D)
     {
-        return __cmsg_nxthdr(msg, cmsg);
+        cmsghdr* CMSG_NXTHDR( msghdr* mhdr, cmsghdr* cmsg )
+        {
+            cmsghdr* __ptr = cast(cmsghdr*) ((cast(ubyte*) cmsg) + CMSG_ALIGN(cmsg.cmsg_len));
+            return cast(c_ulong)( cast(char*)(__ptr+1) - cast(char*) mhdr.msg_control) > mhdr.msg_controllen ? null : __ptr;
+        }
     }
 
     extern (D) inout(cmsghdr)* CMSG_FIRSTHDR( inout(msghdr)* mhdr ) pure nothrow @nogc
