--- a/src/vendor/rls-analysis/src/loader.rs
+++ b/src/vendor/rls-analysis/src/loader.rs
@@ -88,11 +88,9 @@
             .join("save-analysis");
         // FIXME sys_root_path allows to break out of 'sandbox' - is that Ok?
         let sys_root_path = sys_root_path();
-        let target_triple = extract_target_triple(sys_root_path.as_path());
         let libs_path = sys_root_path
             .join("lib")
             .join("rustlib")
-            .join(&target_triple)
             .join("analysis");
 
         let src_path = sys_root_path
@@ -109,25 +107,6 @@
     }
 }
 
-// FIXME: This can fail when using a custom toolchain in rustup (often linked to
-// `/$rust_repo/build/$target/stage2`)
-fn extract_target_triple(sys_root_path: &Path) -> String {
-    // Extracts nightly-x86_64-pc-windows-msvc from
-    // $HOME/.rustup/toolchains/nightly-x86_64-pc-windows-msvc
-    let toolchain = sys_root_path
-        .iter()
-        .last()
-        .and_then(OsStr::to_str)
-        .expect("extracting toolchain failed");
-    // Extracts x86_64-pc-windows-msvc from nightly-x86_64-pc-windows-pc
-    let triple = toolchain
-        .splitn(2, '-')
-        .last()
-        .map(String::from)
-        .expect("extracting triple failed");
-    triple
-}
-
 fn sys_root_path() -> PathBuf {
     env::var("SYSROOT")
         .ok()
--- a/src/bootstrap/bootstrap.py
+++ b/src/bootstrap/bootstrap.py
@@ -599,10 +599,6 @@
                 os.path.join(self.rust_root, "src/bootstrap/Cargo.toml")]
         for _ in range(1, self.verbose):
             args.append("--verbose")
-        if self.use_locked_deps:
-            args.append("--locked")
-        if self.use_vendored_sources:
-            args.append("--frozen")
         run(args, env=env, verbose=self.verbose)
 
     def build_triple(self):
--- a/src/vendor/rls-analysis/.cargo-checksum.json
+++ b/src/vendor/rls-analysis/.cargo-checksum.json
@@ -1 +1 @@
-{"files":{".cargo-ok":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",".gitignore":"9507c2ad1861cc4599474f2fa645a0938dfb381b8c79e307ce1b44780cf10fcd",".travis.yml":"79a4b8dfb1f76bb1fb7126679109a5326fbd2bcadc69765ef98cb431a90a02a4","Cargo.toml":"91f137324c09de1443bcbc36dda00b92200b7f000cf4ae45ecc74478786f1c23","Cargo.toml.orig":"88f5c0047bb8e77116d5e55e0fdc84cc86b82a48234ce80bde2d32ce7359a695","README.md":"3f8b7e6f924b74fdc7affa314d3b029090c4838c63d3420e8d6b3aa6eff448d2","benches/std_api_crate.rs":"d74c62201b6c9fc13a63acdc6c7013bf618633e8b0965a802315ca516f56742f","src/analysis.rs":"5c37742962ec90e5552040d1b35db320d3dd581a270ebbea2637f3d0f3b5303a","src/lib.rs":"204170493ca021bcabf6e0268066a9f00b7e257fec1c1404a3f6e73ccbba8fa7","src/listings/mod.rs":"b3cd49cd4ef69352f79a9a5302bde9d72c5ad192b0c06c4c1a1f1ad6dccd3f99","src/loader.rs":"303c87e19ebd3c2ebd535d6f9f1d70cb33f357db84a226196051590d144dd6a0","src/lowering.rs":"0772df163772a578f104312073d8c6dca31dad48dbcb5c65b49ebedebf89b713","src/raw.rs":"058a8b50516bc87d02dd5733cd477291d7d3e9270bf53d5a05ebb570f3b157bf","src/test/mod.rs":"46da189dad340ad8fa9f4c97a1183172d3b0a85fc6eec9f5645810cf0f9d1042","src/util.rs":"2b6a2a5a46f948818bafd616619242d11161971001b94a15dc071c8c43188047"},"package":"a41488cf5dc99d6ce383319d2978756567b70d4ed0539eb0d9ce07763e732e46"}
\ No newline at end of file
+{"files":{".cargo-ok":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",".gitignore":"9507c2ad1861cc4599474f2fa645a0938dfb381b8c79e307ce1b44780cf10fcd",".travis.yml":"79a4b8dfb1f76bb1fb7126679109a5326fbd2bcadc69765ef98cb431a90a02a4","Cargo.toml":"91f137324c09de1443bcbc36dda00b92200b7f000cf4ae45ecc74478786f1c23","Cargo.toml.orig":"88f5c0047bb8e77116d5e55e0fdc84cc86b82a48234ce80bde2d32ce7359a695","README.md":"3f8b7e6f924b74fdc7affa314d3b029090c4838c63d3420e8d6b3aa6eff448d2","benches/std_api_crate.rs":"d74c62201b6c9fc13a63acdc6c7013bf618633e8b0965a802315ca516f56742f","src/analysis.rs":"5c37742962ec90e5552040d1b35db320d3dd581a270ebbea2637f3d0f3b5303a","src/lib.rs":"204170493ca021bcabf6e0268066a9f00b7e257fec1c1404a3f6e73ccbba8fa7","src/listings/mod.rs":"b3cd49cd4ef69352f79a9a5302bde9d72c5ad192b0c06c4c1a1f1ad6dccd3f99","src/loader.rs":"6eef6e4094da1b520d9e7a7ede474374ce5406e5e97f2b7c46ab1e50beb85a07","src/lowering.rs":"0772df163772a578f104312073d8c6dca31dad48dbcb5c65b49ebedebf89b713","src/raw.rs":"058a8b50516bc87d02dd5733cd477291d7d3e9270bf53d5a05ebb570f3b157bf","src/test/mod.rs":"46da189dad340ad8fa9f4c97a1183172d3b0a85fc6eec9f5645810cf0f9d1042","src/util.rs":"2b6a2a5a46f948818bafd616619242d11161971001b94a15dc071c8c43188047"},"package":"a41488cf5dc99d6ce383319d2978756567b70d4ed0539eb0d9ce07763e732e46"}

