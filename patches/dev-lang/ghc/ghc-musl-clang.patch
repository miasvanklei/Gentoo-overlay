--- a/configure	2016-09-30 09:55:09.078030370 +0200
+++ b/configure	2016-09-30 09:56:06.605025637 +0200
@@ -8203,9 +8203,9 @@
     # If gcc knows about the stack protector, turn it off.
     # Otherwise the stack-smash handler gets triggered.
     echo 'int main(void) {return 0;}' > conftest.c
-    if $CC -c conftest.c -fno-stack-protector > /dev/null 2>&1
+    if $CC -c conftest.c > /dev/null 2>&1
     then
-        CFLAGS="$CFLAGS -fno-stack-protector"
+        CFLAGS="$CFLAGS"
     fi
 
     rm -f conftest.c conftest.o
@@ -8292,9 +8292,9 @@
     # If gcc knows about the stack protector, turn it off.
     # Otherwise the stack-smash handler gets triggered.
     echo 'int main(void) {return 0;}' > conftest.c
-    if $CC -c conftest.c -fno-stack-protector > /dev/null 2>&1
+    if $CC -c conftest.c > /dev/null 2>&1
     then
-        CONF_CC_OPTS_STAGE0="$CONF_CC_OPTS_STAGE0 -fno-stack-protector"
+        CONF_CC_OPTS_STAGE0="$CONF_CC_OPTS_STAGE0"
     fi
 
     rm -f conftest.c conftest.o
@@ -8381,9 +8381,9 @@
     # If gcc knows about the stack protector, turn it off.
     # Otherwise the stack-smash handler gets triggered.
     echo 'int main(void) {return 0;}' > conftest.c
-    if $CC -c conftest.c -fno-stack-protector > /dev/null 2>&1
+    if $CC -c conftest.c > /dev/null 2>&1
     then
-        CONF_CC_OPTS_STAGE1="$CONF_CC_OPTS_STAGE1 -fno-stack-protector"
+        CONF_CC_OPTS_STAGE1="$CONF_CC_OPTS_STAGE1"
     fi
 
     rm -f conftest.c conftest.o
@@ -8470,9 +8470,9 @@
     # If gcc knows about the stack protector, turn it off.
     # Otherwise the stack-smash handler gets triggered.
     echo 'int main(void) {return 0;}' > conftest.c
-    if $CC -c conftest.c -fno-stack-protector > /dev/null 2>&1
+    if $CC -c conftest.c > /dev/null 2>&1
     then
-        CONF_CC_OPTS_STAGE2="$CONF_CC_OPTS_STAGE2 -fno-stack-protector"
+        CONF_CC_OPTS_STAGE2="$CONF_CC_OPTS_STAGE2"
     fi
 
     rm -f conftest.c conftest.o
--- a/aclocal.m4	2016-09-30 09:56:11.279025252 +0200
+++ b/aclocal.m4	2016-09-30 09:56:33.229023446 +0200
@@ -606,9 +606,9 @@
     # If gcc knows about the stack protector, turn it off.
     # Otherwise the stack-smash handler gets triggered.
     echo 'int main(void) {return 0;}' > conftest.c
-    if $CC -c conftest.c -fno-stack-protector > /dev/null 2>&1
+    if $CC -c conftest.c > /dev/null 2>&1
     then
-        $2="$$2 -fno-stack-protector"
+        $2="$$2"
     fi
 
     rm -f conftest.c conftest.o
--- a/compiler/main/DynFlags.hs	2016-09-30 22:46:08.463224003 +0200
+++ b/compiler/main/DynFlags.hs	2016-09-30 22:47:07.538219142 +0200
@@ -3629,16 +3629,7 @@
     where platform = sTargetPlatform settings
 
 default_PIC :: Platform -> [GeneralFlag]
-default_PIC platform =
-  case (platformOS platform, platformArch platform) of
-    (OSDarwin, ArchX86_64) -> [Opt_PIC]
-    (OSOpenBSD, ArchX86_64) -> [Opt_PIC] -- Due to PIE support in
-                                         -- OpenBSD since 5.3 release
-                                         -- (1 May 2013) we need to
-                                         -- always generate PIC. See
-                                         -- #10597 for more
-                                         -- information.
-    _                      -> []
+default_PIC platform = [Opt_PIC]
 
 -- General flags that are switched on/off when other general flags are switched
 -- on
--- a/compiler/main/DriverPipeline.hs	2016-09-30 22:10:45.574398681 +0200
+++ b/compiler/main/DriverPipeline.hs	2016-09-30 22:41:42.811245861 +0200
@@ -2145,7 +2145,8 @@
       osInfo = platformOS (targetPlatform dflags)
       ld_r args cc = SysTools.runLink dflags ([
                        SysTools.Option "-nostdlib",
-                       SysTools.Option "-Wl,-r"
+                       SysTools.Option "-Wl,-r",
+                       SysTools.Option "-fno-pie"
                      ]
                      ++ (if any (cc ==) [Clang, AppleClang, AppleClang51]
                           then []
--- a/mk/ways.mk	2017-11-24 15:22:07.242174825 +0100
+++ b/mk/ways.mk	2017-11-24 15:23:13.309048017 +0100
@@ -42,15 +42,15 @@
 
 # Way 'v':
 WAY_v_NAME=vanilla
-WAY_v_HC_OPTS= -static
+WAY_v_HC_OPTS= -static -fPIC
 
 # Way 'p':
 WAY_p_NAME=profiling
-WAY_p_HC_OPTS= -static -prof -eventlog
+WAY_p_HC_OPTS= -static -fPIC -prof -eventlog
 
 # Way 'l':
 WAY_l_NAME=event logging
-WAY_l_HC_OPTS= -static -eventlog
+WAY_l_HC_OPTS= -static -fPIC -eventlog
 
 #
 # These ways apply to the RTS only:
@@ -58,35 +58,35 @@
 
 # Way 'thr':
 WAY_thr_NAME=threaded
-WAY_thr_HC_OPTS= -static -optc-DTHREADED_RTS
+WAY_thr_HC_OPTS= -static -fPIC -optc-DTHREADED_RTS
 
 # Way 'thr_p':
 WAY_thr_p_NAME=threaded profiling
-WAY_thr_p_HC_OPTS= -static -prof -eventlog -optc-DTHREADED_RTS
+WAY_thr_p_HC_OPTS= -static -fPIC -prof -eventlog -optc-DTHREADED_RTS
 
 # Way 'thr_l':
 WAY_thr_l_NAME=threaded event logging
-WAY_thr_l_HC_OPTS= -static -optc-DTHREADED_RTS -eventlog
+WAY_thr_l_HC_OPTS= -static -fPIC -optc-DTHREADED_RTS -eventlog
 
 # Way 'debug':
 WAY_debug_NAME=debug
-WAY_debug_HC_OPTS= -static -optc-DDEBUG -ticky -DTICKY_TICKY -eventlog
+WAY_debug_HC_OPTS= -static -fPIC -optc-DDEBUG -ticky -DTICKY_TICKY -eventlog
 
 # Way 'debug_p':
 WAY_debug_p_NAME=debug profiled
-WAY_debug_p_HC_OPTS= -static -optc-DDEBUG -prof -eventlog
+WAY_debug_p_HC_OPTS= -static -fPIC -optc-DDEBUG -prof -eventlog
 
 # Way 'p':
 WAY_p_NAME=profiling
-WAY_p_HC_OPTS= -static -prof -eventlog
+WAY_p_HC_OPTS= -static -fPIC -prof -eventlog
 
 # Way 'thr_debug':
 WAY_thr_debug_NAME=threaded debug
-WAY_thr_debug_HC_OPTS= -static -optc-DTHREADED_RTS -optc-DDEBUG -eventlog
+WAY_thr_debug_HC_OPTS= -static -fPIC -optc-DTHREADED_RTS -optc-DDEBUG -eventlog
 
 # Way 'thr_debug_p':
 WAY_thr_debug_p_NAME=threaded debug profiling event logging
-WAY_thr_debug_p_HC_OPTS= -static -optc-DTHREADED_RTS -optc-DDEBUG -prof -eventlog
+WAY_thr_debug_p_HC_OPTS= -static -fPIC -optc-DTHREADED_RTS -optc-DDEBUG -prof -eventlog
 
 # Way 'dyn': build dynamic shared libraries
 WAY_dyn_NAME=dyn
