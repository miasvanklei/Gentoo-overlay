--- a/qt6/platforminputcontext/CMakeLists.txt	2023-12-20 20:19:56.390186265 +0100
+++ b/qt6/platforminputcontext/CMakeLists.txt	2023-12-20 20:19:01.859725588 +0100
@@ -46,11 +46,15 @@
                           Qt6::GuiPrivate
                           Qt6::DBus
                           Qt6::Widgets
-                          XCB::XCB
                           Fcitx5Qt6::DBusAddons
                           XKBCommon::XKBCommon
                          )
 
+if (ENABLE_X11)
+    target_link_libraries(fcitx5platforminputcontextplugin-qt6 XCB::XCB)
+    target_compile_definitions(fcitx5platforminputcontextplugin-qt6 PRIVATE "-DENABLE_X11")
+endif()
+
 if (ENABLE_QT6_WAYLAND_WORKAROUND)
     target_compile_definitions(fcitx5platforminputcontextplugin-qt6 PRIVATE "-DFCITX_ENABLE_QT6_WAYLAND_WORKAROUND")
     target_link_libraries(fcitx5platforminputcontextplugin-qt6
